<!DOCTYPE HTML>
<html>
    <head>
		<!-- jQuery UI Dependencies -->
		<link href="jquery-ui-1.9.1.custom/css/smoothness/jquery-ui-1.9.1.custom.css" rel="stylesheet">
		<script src="jquery-ui-1.9.1.custom/js/jquery-1.8.2.js"></script>
		<script src="jquery-ui-1.9.1.custom/js/jquery-ui-1.9.1.custom.js"></script>
		<style>
		  body {
			  font-size: 12px;
		  }
		</style>
		
		<!-- Game Dependencies -->
        <script src="Geometry.js" ></script>
        <script src="MovingObject.js" ></script>
        <script src="RenderablePolygon.js" ></script>
        <script src="CityMap.js" ></script>
        <script src="GameUnits.js" ></script>
        <script src="ZombieAI.js" ></script>
        <script src="CivilianAI.js" ></script>
        <script src="SoldierAI.js" ></script>
        <script src="Influencers.js" ></script>
        <script src="SFX.js" ></script>
        <script src="GameEngine.js" ></script>
        <script>
            var GE; //Game engine Global variable
            var GAME_WIDTH = 640;
            var GAME_HEIGHT = 480;
            
            
            
            window.onload = function() {
	        // Create a new GameEngine tied to a specific HTML5 Canvas.
                canvas = document.getElementById("gameCanvas");
                context = canvas.getContext("2d");
                
                GE = new GameEngine(canvas);
                GE.init(canvas);
				GE.setDebugCanvas(debugCameraCanvas);
                GE.newGame();
                GE.start();
            };
        </script>
    </head>
    
    <body>
        <table width="100%">
            <tr>
                <td colspan="2" align="center"><h3>JS-Zombies</h3></td>
            </tr>
			
            <tr>
                <td width="650" valign="top">
                    <!-- Game canvas -->
                    <canvas id="gameCanvas" width="640" height="480"></canvas>
                </td>
                
				
				
				
				
				
				
                <td valign="top" rowspan="2">
					<div id="sidebar_tabs">
					  <ul>
						  <li><a href="#sidebar_main-tab">Main</a></li>
						  <li><a href="#sidebar_debug-tab">Debug</a></li>
					  </ul>
					  
					  
					  
					  <div id="sidebar_main-tab">
						<!-- Description -->
						<b>Game State:</b><br/>
						<span id="count_zombies" style=""></span>/
						<span id="count_civilians" style="" ></span>/
						<span id="count_total" style="" ></span><br/><br/>
						
						<script>
						  var count_zombies_lbl = document.getElementById("count_zombies");
						  var count_civilians_lbl = document.getElementById("count_civilians");
						  var count_total_lbl = document.getElementById("count_total");
						</script>
						
						
						<b>Controls</b><br/>
						
						<b>Zombie Influence Powers</b><br/>
						(<em>Click then select on the map where to place</em>)<br/>
						<input type="button" id="infl_left_btn" value="Move Left" /><br/>
						<input type="button" id="infl_right_btn" value="Move Right" /><br/>
						<input type="button" id="infl_up_btn" value="Move Up" /><br/>
						<input type="button" id="infl_down_btn" value="Move Down" /><br/>
						<br/>
						<input type="button" id="infl_clear_btn" value="Clear" /><br/>
						
						<script>
						  // Button setup
						  var influence_ids = ["infl_left_btn",
											   "infl_right_btn",
											   "infl_up_btn",
											   "infl_down_btn"];
						  
						  // TODO: Have this done in a more elegant fashion.
						  //  (On the other hand, this is a temporary job anyway)
						  var west_btn = document.getElementById("infl_left_btn");
						  west_btn.onclick = function(){
							console.log("Mouse Clicked!W");
							var dir = ROAD_DIRECTION_WEST;
							var v = getUnitVectorForDirection(dir);
							var inflr = new MovementInfluencer({x: GAME_WIDTH / 2,
																y: GAME_WIDTH / 2,
																radius: 100,
                                                                duration: 3000,
                                                                opacityFunction: sqrt_decrease,
																direction: dir});
							GE.setCurrentInfluencer(inflr);
						  }
						  
						  
						  var east_btn = document.getElementById("infl_right_btn");
						  east_btn.onclick = function(){
							console.log("Mouse Clicked!E");
							var dir = ROAD_DIRECTION_EAST;
							var inflr = new MovementInfluencer({x: GAME_WIDTH / 2,
																y: GAME_WIDTH / 2,
																radius: 100,
                                                                duration: 3000,
                                                                opacityFunction: sqrt_decrease,
																direction: dir});
							GE.setCurrentInfluencer(inflr);
						  }
						  
						  
						  var nth_btn = document.getElementById("infl_up_btn");
						  nth_btn.onclick = function(){
							console.log("Mouse Clicked!N");
							var dir = ROAD_DIRECTION_NORTH;
							var inflr = new MovementInfluencer({x: GAME_WIDTH / 2,
																y: GAME_WIDTH / 2,
																radius: 100,
                                                                duration: 3000,
                                                                opacityFunction: sqrt_decrease,
																direction: dir});
							GE.setCurrentInfluencer(inflr);
						  }
						  
						  
						  var sth_btn = document.getElementById("infl_down_btn");
						  sth_btn.onclick = function(){
							console.log("Mouse Clicked!");
							var dir = ROAD_DIRECTION_SOUTH;
							var inflr = new MovementInfluencer({x: GAME_WIDTH / 2,
																y: GAME_WIDTH / 2,
																radius: 100,
                                                                duration: 3000,
                                                                opacityFunction: sqrt_decrease,
																direction: dir});	
							GE.setCurrentInfluencer(inflr);					
						  }
						  
						  
						  var clear_btn = document.getElementById("infl_clear_btn");
						  clear_btn.onclick = function(){
							console.log("Mouse Clicked!none");
							GE.setCurrentInfluencer(null);
						  }
						</script>
					  </div>
					  
					  
					  
					  <div id="sidebar_debug-tab">
						<b>Debug Tab</b><br/><br/>
						
						<b>Game Speed:</b><br/>
						<input id="gameSpeedSlider" type="range" value="1" min="0.1" max="2" step="0.1" />
						<span id="gameSpeedLabel"></span><br/>
						<br/>
						<script>
						  var gameSpeedSlider = document.getElementById("gameSpeedSlider");
						  var gameSpeedLabel = document.getElementById("gameSpeedLabel");
						</script>
						
						<b>Camera:</b><br/>
						<table width="100%">
						  <tr>
							<td width="320">
							  <!-- Debug Canvas for Camera -->
							  <canvas id="debugCameraCanvas" width="320" height="240"></canvas>
							  <script>
								var debugCameraCanvas = document.getElementById("debugCameraCanvas");
							  </script>
							</td>
							<td valign="top">
							  <!-- Debug Canvas Zoom Controls -->
							  <b>Zoom</b><br/>
							  <input id="debugCameraCanvasZoomSlider" type="range" value="0.5" min="0.5" max="5" step="0.05" />
							  <span id="debugCameraCanvasZoomLabel"></span><br/>
							  <br/>
							  <script>
								var debugCameraCanvasZoomSlider = document.getElementById("debugCameraCanvasZoomSlider");
								var debugCameraCanvasZoomLabel = document.getElementById("debugCameraCanvasZoomLabel");
							  </script>
							  
							  <b>Focus on Unit:</b><br>
							  
							  <span id="debugCameraUnitFocusCycle">
								<input type="button" id="debugCameraUnitFocusPrev_btn" value="<" />
								<input type="button" id="debugCameraUnitFocusNext_btn" value=">" />
							  </span>
							  
							  <span id="debugCameraUnitFocus_div" class="ui-widget">
								<!-- Get selected using $("#debugCameraUnitFocus_combo option:selected").val() -->
								<select id="debugCameraUnitFocus_combo">
								  <option value="">None</option>
								</select>
							  </span>
							</td>
						  </tr>
						</table>
						
						
						<style>
						.ui-combobox {
							position: relative;
							display: inline-block;
						}
						.ui-combobox-toggle {
							position: absolute;
							top: 0;
							bottom: 0;
							margin-left: -1px;
							padding: 0;
							/* adjust styles for IE 6/7 */
							*height: 1.7em;
							*top: 0.1em;
						}
						.ui-combobox-input {
							margin: 0;
							padding: 0.3em;
						}
						</style>
						
						<script>
						</script>
					  </div>
					</div>
					
					
					
					<script>
					</script>
                </td>
            </tr>
            <tr>
                <td>
                    <!-- Control buttons -->
                    <input type="button" value="New Game" onclick="GE.newGame();GE.start()" />
                    <input type="button" value="Pause Game" onclick="GE.pause()" />
                    <input type="button" value="Resume Game" onclick="GE.start()" />
                </td>
            </tr>
        </table>
    </body>
</html>
